#include<stdio.h>
#include<string.h>
#include"crc32.h"

#define MAX 255

#define MYCRC 0x1fb61a36

void passwd(char *pass)
{
    if(strcmp(pass,"The Pass")==0)
    {
        printf("Oh Yeah!\n");
    }
}

int main()
{
    unsigned long crc32;
    char pass[MAX];

    //Generates a crc32 of the program
    crc32 = Crc32_ComputeBuf(0,passwd,33);

    //If the crc32 does not match MYCRC the program has bem modified and will exit
    if(crc32!=MYCRC)
    {
        exit(0);
    }

    //If the program maintains its integrity it will execute normally
    printf("Password:\n");

    // BUG
    scanf("%s",pass);
    passwd(pass);
    return 0;
}
